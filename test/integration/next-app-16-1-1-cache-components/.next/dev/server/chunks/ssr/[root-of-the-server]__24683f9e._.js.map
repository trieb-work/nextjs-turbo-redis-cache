{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///Users/jannikzinkl/Documents/git/nextjs-turbo-redis-cache/test/integration/next-app-16-1-1-cache-components/src/app/cache-lab/stale-while-revalidate/page.tsx"],"sourcesContent":["import Link from 'next/link';\nimport { Suspense } from 'react';\nimport { cacheLife, cacheTag, revalidateTag } from 'next/cache';\n\nfunction sleep(ms: number): Promise<void> {\n  return new Promise((resolve) => setTimeout(resolve, ms));\n}\n\nasync function getSlowTaggedValue() {\n  'use cache';\n\n  // Keep this short so you can observe SWR behavior quickly.\n  // stale: after 2s the entry is considered stale\n  // revalidate: after 8s Next may attempt to refresh\n  // expire: after 60s it must be recomputed\n  cacheLife({ stale: 2, revalidate: 8, expire: 60 });\n  cacheTag('cache-lab:swr');\n\n  // Make regeneration visibly expensive so you can tell whether the request was\n  // served from stale cache (fast) or blocked on recomputation (slow).\n  await sleep(3000);\n\n  return {\n    computedAt: Date.now(),\n    value: Math.random(),\n    note: 'This function always sleeps ~3s when it actually executes.',\n  };\n}\n\nasync function triggerRevalidateTag() {\n  'use server';\n  revalidateTag('cache-lab:swr', { expire: 1 });\n}\n\nasync function CachedPanel() {\n  const data = await getSlowTaggedValue();\n\n  return (\n    <div className=\"rounded-lg border p-5\">\n      <div className=\"text-sm text-slate-700\">\n        <div>\n          <span className=\"font-medium\">computedAt:</span>{' '}\n          <span data-testid=\"computedAt\" className=\"font-mono\">\n            {data.computedAt}\n          </span>\n        </div>\n        <div className=\"mt-1\">\n          <span className=\"font-medium\">value:</span>{' '}\n          <span data-testid=\"value\" className=\"font-mono\">\n            {data.value}\n          </span>\n        </div>\n        <div className=\"mt-1 text-xs text-slate-500\">{data.note}</div>\n      </div>\n    </div>\n  );\n}\n\nexport default function StaleWhileRevalidatePage() {\n  return (\n    <main className=\"mx-auto max-w-3xl p-10\">\n      <div className=\"mb-6\">\n        <Link\n          className=\"text-sm text-blue-600 hover:underline\"\n          href=\"/cache-lab\"\n        >\n          ← Back to Cache Lab\n        </Link>\n      </div>\n\n      <header className=\"mb-6\">\n        <h1 className=\"text-2xl font-semibold\">\n          SWR: stale-while-revalidate (slow)\n        </h1>\n        <p className=\"mt-2 text-sm text-slate-600\">\n          This page is designed to make stale-while-revalidate behavior visible.\n          The cached function sleeps ~3 seconds whenever it really runs.\n        </p>\n      </header>\n\n      <Suspense\n        fallback={\n          <div className=\"rounded-lg border bg-slate-50 p-5 text-sm text-slate-700\">\n            Loading cached content… (first time can take ~3s)\n          </div>\n        }\n      >\n        <CachedPanel />\n      </Suspense>\n\n      <div className=\"mt-6 flex flex-col gap-3 sm:flex-row\">\n        <form action={triggerRevalidateTag}>\n          <button\n            className=\"w-full rounded-md border border-blue-600 bg-white px-4 py-2 text-sm font-medium text-blue-700 hover:bg-blue-50\"\n            type=\"submit\"\n          >\n            revalidateTag('cache-lab:swr')\n          </button>\n        </form>\n      </div>\n\n      <div className=\"mt-6 rounded-lg border bg-slate-50 p-5 text-sm text-slate-700\">\n        <div className=\"space-y-2\">\n          <p className=\"font-medium\">How to observe SWR (non-blocking)</p>\n          <p>1) Load this page once (expect ~3s on the very first load).</p>\n          <p>\n            2) Wait ~3 seconds so the entry becomes <code>stale</code>{' '}\n            (stale=2s).\n          </p>\n          <p>\n            3) Click <code>revalidateTag</code>.\n          </p>\n          <p>4) Immediately reload the page:</p>\n          <div className=\"rounded bg-white p-3 text-xs\">\n            If SWR is working, the reload should be fast and you may still see\n            the old computedAt/value (stale served).\n            <br />\n            Reload again after ~3-4 seconds and you should see a new\n            computedAt/value.\n            <br />\n            If SWR is not working, the reload will block for ~3 seconds.\n          </div>\n          <div className=\"text-xs text-slate-500\">\n            cacheLife: {'{ stale: 2, revalidate: 8, expire: 60 }'}\n          </div>\n        </div>\n      </div>\n    </main>\n  );\n}\n"],"names":[],"mappings":";;;;;;;;;;;;mMAAA;AAEA;;;;;;;;AAEA,SAAS,MAAM,EAAU;IACvB,OAAO,IAAI,QAAQ,CAAC,UAAY,WAAW,SAAS;AACtD;AAEA,MAAA,6BAAA,eAAe;IAGb,2DAA2D;IAC3D,gDAAgD;IAChD,mDAAmD;IACnD,0CAA0C;IAC1C,IAAA,2SAAS,EAAC;QAAE,OAAO;QAAG,YAAY;QAAG,QAAQ;IAAG;IAChD,IAAA,0SAAQ,EAAC;IAET,8EAA8E;IAC9E,qEAAqE;IACrE,MAAM,MAAM;IAEZ,OAAO;QACL,YAAY,KAAK,GAAG;QACpB,OAAO,KAAK,MAAM;QAClB,MAAM;IACR;AACF;IAnBA,4YAAA,SAAe;WAAf;;AAAA;;;;IAAe;MAqBf,wBAAA,eAAe;IAEb,IAAA,+SAAa,EAAC,iBAAiB;QAAE,QAAQ;IAAE;AAC7C;gZAHA;IAAe,uBAAf;AAKA,eAAe;IACb,MAAM,OAAO,MAAM;IAEnB,qBACE,+YAAC;QAAI,WAAU;kBACb,cAAA,+YAAC;YAAI,WAAU;;8BACb,+YAAC;;sCACC,+YAAC;4BAAK,WAAU;sCAAc;;;;;;wBAAmB;sCACjD,+YAAC;4BAAK,eAAY;4BAAa,WAAU;sCACtC,KAAK,UAAU;;;;;;;;;;;;8BAGpB,+YAAC;oBAAI,WAAU;;sCACb,+YAAC;4BAAK,WAAU;sCAAc;;;;;;wBAAc;sCAC5C,+YAAC;4BAAK,eAAY;4BAAQ,WAAU;sCACjC,KAAK,KAAK;;;;;;;;;;;;8BAGf,+YAAC;oBAAI,WAAU;8BAA+B,KAAK,IAAI;;;;;;;;;;;;;;;;;AAI/D;AAEe,SAAS;IACtB,qBACE,+YAAC;QAAK,WAAU;;0BACd,+YAAC;gBAAI,WAAU;0BACb,cAAA,+YAAC,2VAAI;oBACH,WAAU;oBACV,MAAK;8BACN;;;;;;;;;;;0BAKH,+YAAC;gBAAO,WAAU;;kCAChB,+YAAC;wBAAG,WAAU;kCAAyB;;;;;;kCAGvC,+YAAC;wBAAE,WAAU;kCAA8B;;;;;;;;;;;;0BAM7C,+YAAC,kXAAQ;gBACP,wBACE,+YAAC;oBAAI,WAAU;8BAA2D;;;;;;0BAK5E,cAAA,+YAAC;;;;;;;;;;0BAGH,+YAAC;gBAAI,WAAU;0BACb,cAAA,+YAAC;oBAAK,QAAQ;8BACZ,cAAA,+YAAC;wBACC,WAAU;wBACV,MAAK;kCACN;;;;;;;;;;;;;;;;0BAML,+YAAC;gBAAI,WAAU;0BACb,cAAA,+YAAC;oBAAI,WAAU;;sCACb,+YAAC;4BAAE,WAAU;sCAAc;;;;;;sCAC3B,+YAAC;sCAAE;;;;;;sCACH,+YAAC;;gCAAE;8CACuC,+YAAC;8CAAK;;;;;;gCAAa;gCAAI;;;;;;;sCAGjE,+YAAC;;gCAAE;8CACQ,+YAAC;8CAAK;;;;;;gCAAoB;;;;;;;sCAErC,+YAAC;sCAAE;;;;;;sCACH,+YAAC;4BAAI,WAAU;;gCAA+B;8CAG5C,+YAAC;;;;;gCAAK;8CAGN,+YAAC;;;;;gCAAK;;;;;;;sCAGR,+YAAC;4BAAI,WAAU;;gCAAyB;gCAC1B;;;;;;;;;;;;;;;;;;;;;;;;AAMxB"}},
    {"offset": {"line": 353, "column": 0}, "map": {"version":3,"sources":["file:///Users/jannikzinkl/Documents/git/nextjs-turbo-redis-cache/test/integration/next-app-16-1-1-cache-components/.next-internal/server/app/cache-lab/stale-while-revalidate/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {$$RSC_SERVER_ACTION_1 as '00dc4b8782e8c18ad0faea03b6acdc4eb0a9ea320e'} from 'ACTIONS_MODULE0'\nexport {$$RSC_SERVER_CACHE_0 as '806ca397b266b773c48ba04e69aeb14ac88d80fe48'} from 'ACTIONS_MODULE0'\n"],"names":[],"mappings":";AAAA"}}]
}